(self.wpJsonpPcmallFlashsale=self.wpJsonpPcmallFlashsale||[]).push([[731],{6143:function(t,e,n){"use strict";n.d(e,{IJ:function(){return o},Xu:function(){return s}});var r,i=n(6171),a=n(9006);!function(){switch((0,a.Kd)()){case"ID":case"TW":case"VN":case"TH":case"MY":case"SG":case"PH":;}}(),function(t){t.ADD="add",t.DELETE="delete"}(r||(r={}));var o=(0,i.n)("FETCH_BRAND_SALE_ALL_SESSIONS"),s=((0,i.n)("BATCH_FETCH_BRAND_SALE_ITEMS"),(0,i.n)("FETCH_BRAND_SALE_ITEMS"),(0,i.n)("FETCH_BRAND_SALE_SOLDOUT_ITEM"));(0,i.n)("FETCH_BRAND_SALE_ALL_ITEMS_IDS")},5462:function(t,e,n){"use strict";n.d(e,{Sc:function(){return u},dz:function(){return c},Gz:function(){return _},oE:function(){return i},TC:function(){return a},_1:function(){return m},uO:function(){return A},Yv:function(){return f},iw:function(){return d},g8:function(){return E},JB:function(){return l},WK:function(){return S},gJ:function(){return p},O9:function(){return I}});var r,i,a,o=n(4219),s=n(4676),u=5,c=10,_=50;!function(t){t[t.FLASH_SALE=0]="FLASH_SALE",t[t.BRAND_SALE=1]="BRAND_SALE",t[t.SHOP_FLASH_SALE=2]="SHOP_FLASH_SALE",t[t.FLASH_SALE_CATEGORY=3]="FLASH_SALE_CATEGORY"}(i||(i={})),function(t){t.FLASH_SALE="flash_sale",t.BRAND_SALE="brand_sale",t.SHOP_FLASH_SALE="shop_flash_sale",t.MICROSITE_FLASH_SALE="microsite_flash_sale",t.MICROSITE_SHOP_FLASH_SALE="microsite_shop_flash_sale"}(a||(a={}));var f,d,E,l,S,m=new Set(["test","uat","live"]),A=[0,1,2,3,4];!function(t){t.FLASH_SALE_LANDING="flashSaleLanding",t.FLASH_SALE_ENTRANCE="flashSaleEntrance",t.BRAND_SALE_ENTRANCE="brandSaleEntrance",t.BRAND_SALE_LANDING="brandSaleLanding",t.SMART_FLASH_SALE_ENTRANCE="smartFlashSaleEntrance",t.SMART_FLASH_SALE_LANDING="smartFlashSaleLanding",t.SHOP_ENTRANCE="shopEntrance",t.SHOP_FLASH_SALE="shopFlashSale",t.SHOP_CAMPAIGN="shopCampaign",t.FLASH_SALE_MICROSITE="flashSaleMicrosite",t.SOLD_OUT_PAGE="soldOutPage"}(f||(f={})),function(t){t.PC="pc",t.RW="rw"}(d||(d={})),function(t){t.SALE_PRICE="sale_price",t.ORIGINAL_PRICE="original_price",t.HIDDEN_PRICE="hidden_price"}(E||(E={})),function(t){t.BUY_NOW="buy_now",t.VIEW_DETAILS="view_details"}(l||(l={})),function(t){t.RW_VERTICAL_ITEM_CARD="rw_vertical_item_card",t.RW_HORIZONTAL_ITEM_CARD="rw_horizontal_item_card",t.PC_LANDING_PAGE_ITEM_CARD="pc_landing_page_item_card",t.PC_ENTRANCE_PAGE_ITEM_CARD="pc_entrance_page_item_card"}(S||(S={}));var p=new Set(["PL","ES"]),I=new Set(["MX"]);(r={})[f.FLASH_SALE_LANDING]=o.LX,r[f.SMART_FLASH_SALE_LANDING]=s.iO},7752:function(t,e,n){"use strict";n.d(e,{IG:function(){return i},Gl:function(){return o},$X:function(){return s},bG:function(){return u}});var r,i,a=n(6171);!function(t){t[t.FLASH_SALE=0]="FLASH_SALE",t[t.BRAND_SALE=1]="BRAND_SALE",t[t.SHOP_FLASH_SALE=2]="SHOP_FLASH_SALE",t[t.FLASH_SALE_CATEGORY=3]="FLASH_SALE_CATEGORY"}(i||(i={}));var o={system_generated:1,flash_sale_category:2,customised:3},s={SYSTEM_GENERATED:"system_generated",FLASH_SALE_CATEGORY:"flash_sale_category",CUSTOMISED:"customised"},u=((r={default:0}).deboost_for_customized_item_order=1,r.hide_from_ongoing_session=2,(0,a.n)("FETCH_MICROSITE_SOLDOUT_ITEM"))},4219:function(t,e,n){"use strict";n.d(e,{g$:function(){return u},s5:function(){return c},pw:function(){return _},LX:function(){return f},tl:function(){return d},Tx:function(){return r},aH:function(){return i},_M:function(){return a},Af:function(){return o},mL:function(){return E},Ft:function(){return l},gm:function(){return S},Vs:function(){return m},c5:function(){return A},u:function(){return p},H6:function(){return I},gM:function(){return L},Oy:function(){return T},Ex:function(){return h},hh:function(){return O},gH:function(){return v}});var r,i,a,o,s=n(6171),u=0,c=0,_=16,f=25,d=999;!function(t){t[t.SHOPEE_ITEM=0]="SHOPEE_ITEM",t[t.DIGITAL_PURCHASE=1]="DIGITAL_PURCHASE"}(r||(r={})),function(t){t[t.COMING_SOON=0]="COMING_SOON",t[t.ON_GOING=1]="ON_GOING",t[t.ENDED=2]="ENDED"}(i||(i={})),function(t){t[t.UNDEFINED=0]="UNDEFINED",t[t.START=1]="START",t[t.END=2]="END"}(a||(a={})),function(t){t.SESSION_ENDS="session_ends",t.TIME_OFF_SYNC="time_off_sync",t.NO_SELLING_OUT="no_selling_out"}(o||(o={}));var E=(0,s.n)("FETCH_FLASH_SALE_ALL_SESSIONS"),l=(0,s.n)("FETCH_FLASH_SALE_ITEM_IDS"),S=(0,s.n)("BATCH_FETCH_FLASH_SALE_ITEMS"),m=(0,s.n)("FETCH_FLASH_SALE_ITEMS"),A=(0,s.n)("FETCH_FLASH_SALE_SOLDOUT_ITEM"),p="UPDATE_SELECTED_CFS_PROMOTION_AND_CATEGORY_ID",I=" UPDATE_SELECTED_CATEGORY_ID",L="UPDATE_SELECTED_CFS_PROMOTION_ID",T="SET_SHOULD_MOVE_BARS_UP",h="REORDER_ITEMS",O="UPDATE_FLASH_SALE_ITEM_IDS",v="RESET_INITIAL_FETCH_STATUS"},8244:function(t,e,n){"use strict";var r;n.d(e,{a:function(){return r},g:function(){return i}}),function(t){t[t.INIT=0]="INIT",t[t.REQ=1]="REQ",t[t.OK=2]="OK",t[t.ERR=3]="ERR"}(r||(r={}));var i=0},4676:function(t,e,n){"use strict";n.d(e,{Mm:function(){return i},NY:function(){return a},iO:function(){return o},HK:function(){return s},hz:function(){return u},EX:function(){return c},y_:function(){return _},N9:function(){return f},rW:function(){return d},Js:function(){return E},S4:function(){return l},q2:function(){return S},jP:function(){return m}});var r=n(6171),i=0,a=20,o=25,s=6,u=6,c=6,_=6,f=(0,r.n)("FETCH_SMART_FLASH_SALE_ALL_SESSIONS"),d=(0,r.n)("FETCH_SMART_FLASH_SALE_ALL_ITEM_IDS"),E=(0,r.n)("BATCH_FETCH_SMART_FLASH_SALE_ITEMS"),l="UPDATE_SELECTED_SMART_PROMOTION_ID",S="REORDER_SMRAT_FLASH_SALE_ITEMS",m="UPDATE_SMART_FLASH_SALE_ITEM_IDS"},6944:function(t,e,n){"use strict";n.d(e,{Ug:function(){return r},tk:function(){return i},KE:function(){return a},vm:function(){return o},g1:function(){return s},KF:function(){return u}});var r="BATCH_FETCH_FLASH_SALE_BY_PROMOTIONIDS_REQUESTED",i="BATCH_FETCH_FLASH_SALE_BY_PROMOTIONIDS_SUCCESS",a="BATCH_FETCH_FLASH_SALE_BY_PROMOTIONIDS_FAILED",o="switch_tab",s="/api/v2/flash_sale/get_shop_flash_sales_by_promotionids",u="/api/v4/flash_sale/get_selected_flash_sales_by_promotionids"},6977:function(t,e,n){"use strict";n.d(e,{UO:function(){return S},RF:function(){return m},nu:function(){return A},TN:function(){return p},NR:function(){return I},Zk:function(){return h},ds:function(){return O}});var r=n(1180),i=n(5779),a=n(6704),o=n(9006),s=n(5462),u=n(6594),c=n(9035),_=n(7944),f=n(3398),d=(0,o.Kd)(),E=a.I18n.t,l=(0,r.getUtilsByCountry)(d,(0,o.of)()).compactServerCurrency,S=function(t){return(0,i.AW)(t.search)};function m(t){if(t){if(t.discount_value)return E("label_voucher_product_value_discount",{value:l(t.discount_value)});if(t.discount_percentage)return E("label_voucher_product_percentage_discount",{value:(e=t.discount_percentage,"zh-Hant"===(0,o.of)()?Math.round(100-e)/10:Math.round(e))});if(t.coin_percentage)return E("label_voucher_product_coins_cashback",{value:t.coin_percentage})}var e;return null}function A(t,e,n,r){switch(void 0===r&&(r=!1),e){case s.Yv.FLASH_SALE_ENTRANCE:var i=n.promotionId,a=n.itemId,o=n.categoryId,_=n.shopId;return r?(0,u.gW)(t).getUrl({promotionId:i,fromItem:a,fromShop:_}):(0,u.Zz)(t).getUrl({promotionId:i,fromItem:a,categoryId:o});case s.Yv.BRAND_SALE_ENTRANCE:var f=n.promotionId,d=n.itemId,E=n.shopId;return(0,u.gW)(t).getUrl({promotionId:f,fromItem:d,fromShop:E});case s.Yv.SMART_FLASH_SALE_ENTRANCE:var l=n.promotionId,S=n.itemId;return(0,u.tN)(t).getUrl({promotionId:l,fromItem:S});case s.Yv.SHOP_ENTRANCE:case s.Yv.SHOP_FLASH_SALE:case s.Yv.SHOP_CAMPAIGN:case s.Yv.FLASH_SALE_LANDING:case s.Yv.BRAND_SALE_LANDING:case s.Yv.SMART_FLASH_SALE_LANDING:case s.Yv.SOLD_OUT_PAGE:var m=n.shopId,A=n.itemId,p=n.name;return m&&A?p?c.Z.getUrl({seoName:p,shopId:m,itemId:A}):c.O.getUrl({shopId:m,itemId:A}):"";default:return""}}function p(t,e){if(void 0===e&&(e=!1),e)switch(t){case s.oE.FLASH_SALE:case s.oE.BRAND_SALE:case s.oE.FLASH_SALE_CATEGORY:return s.TC.MICROSITE_FLASH_SALE;case s.oE.SHOP_FLASH_SALE:return s.TC.MICROSITE_SHOP_FLASH_SALE;default:return s.TC.MICROSITE_FLASH_SALE}else switch(t){case s.oE.FLASH_SALE:return s.TC.FLASH_SALE;case s.oE.BRAND_SALE:return s.TC.BRAND_SALE;case s.oE.SHOP_FLASH_SALE:return s.TC.SHOP_FLASH_SALE}}function I(t,e){var n,r;return(null==t||null===(n=t.item)||void 0===n?void 0:n.itemid)===(null==e||null===(r=e.item)||void 0===r?void 0:r.itemid)}var L=(0,f.S)((0,o.of)()),T=_.formatDuration.bind(null,_.durationLocales[L]),h=function(t,e){if(t){var n="TW"===__LOCALE__?(100-t.extra_discount)/10:t.extra_discount,r="";if(t.end_time&&t.start_time&&(i=t.start_time,a=t.end_time,o=new Date(1e3*a),s=new Date(1e3*i),u=(0,_.timeBetween)("minute",o,s),r=T(o,s,{totalUnits:1,endUnit:"minute",roundLast:u>60?"floor":u<1?"ceil":"round",unitLowerBounds:{year:Number.MAX_VALUE,month:Number.MAX_VALUE,week:Number.MAX_VALUE,day:Number.MAX_VALUE}})),t&&"function"==typeof e)return r?e("fs_extra_n_off_applied_for_first_m_in_x",{n:n,m:t.extra_discount_stock,x:r}):e("fs_extra_n_off_applied_for_first_m",{n:n,m:t.extra_discount_stock})}var i,a,o,s,u;return""},O=function(t){return function(t){return t.map((function(t){var e=t.start_time,n=Date.now()/1e3;return t.is_ongoing=e<=n,t}))}(function(t){return t.filter((function(t){return t.end_time>Date.now()/1e3}))}(t))}},6353:function(t,e,n){"use strict";n.d(e,{MK:function(){return p},_h:function(){return A},qN:function(){return l},Qg:function(){return S},C1:function(){return m}});var r=n(1408),i={MFS_RCMD:{TEST:"prm.UD",UAT:"prm.JZ",LIVE:"prm.QK"},ITEM_CARD_REVAMP:{TEST:"prm.KO",UAT:"prm.NO",LIVE:"prm.RQ"},FLEX_BOOSTING:{TEST:"prm.OP",UAT:"prm.PS",LIVE:"prm.SC"},CAT_RCMD:{TEST:"prm.KK",UAT:"prm.PF",LIVE:"prm.MV"}},a={TEST:{CONTROL:1,TREAMENT_ONE:2,TREAMENT_TWO:4,TREAMENT_THREE:3},UAT:{CONTROL:1,TREAMENT_ONE:2,TREAMENT_TWO:4,TREAMENT_THREE:3},LIVE:{CONTROL:1,TREAMENT_ONE:2,TREAMENT_TWO:4,TREAMENT_THREE:3}},o={TEST:{MANUAL_RCMD:1,MANUAL_FLEX_RCMD:6,MANUAL_MOVE_FLEX:2,ONLY_RCMD:3,TOP_FIX_MOVE_FLEX:4,TOP_FIX_ONLY_RCMD:5},UAT:{MANUAL_RCMD:1,MANUAL_FLEX_RCMD:6,MANUAL_MOVE_FLEX:2,ONLY_RCMD:3,TOP_FIX_MOVE_FLEX:4,TOP_FIX_ONLY_RCMD:5},LIVE:{MANUAL_RCMD:1,MANUAL_FLEX_RCMD:6,MANUAL_MOVE_FLEX:2,ONLY_RCMD:3,TOP_FIX_MOVE_FLEX:4,TOP_FIX_ONLY_RCMD:5}},s={TEST:{OLD_MANUAL:1,MANUAL_RCMD:2},UAT:{OLD_MANUAL:1,MANUAL_RCMD:2},LIVE:{OLD_MANUAL:1,MANUAL_RCMD:2}},u=n(5462),c=n(9006),_=n(1437),f=n(4174);function d(){var t=(0,c.dU)().toUpperCase(),e=u._1.has(t.toLowerCase());return{ENV:t,isEnvSupported:e}}function E(){var t=d().ENV;return{isInTreamentOne:(0,r.getVariateConfig)(i.ITEM_CARD_REVAMP[t])===a[t].TREAMENT_ONE,isInTreamentTwo:(0,r.getVariateConfig)(i.ITEM_CARD_REVAMP[t])===a[t].TREAMENT_TWO,isInTreamentThree:(0,r.getVariateConfig)(i.ITEM_CARD_REVAMP[t])===a[t].TREAMENT_THREE}}function l(){var t=d().isEnvSupported?E():{},e=t.isInTreamentOne,n=void 0!==e&&e,r=t.isInTreamentTwo,i=void 0!==r&&r,a=t.isInTreamentThree;return n||i||void 0!==a&&a}function S(){var t=d().isEnvSupported?E():{},e=t.isInTreamentOne,n=void 0!==e&&e,r=t.isInTreamentTwo;return n||void 0!==r&&r}function m(){var t=d().isEnvSupported?E():{},e=t.isInTreamentTwo,n=void 0!==e&&e,r=t.isInTreamentThree;return n||void 0!==r&&r}var A=function(){var t=d(),e=t.ENV;if(!t.isEnvSupported||!(0,_.isFeatureEnabled)(f.MS0))return 1;switch((0,r.getVariateConfig)(i.FLEX_BOOSTING[e])){case o[e].MANUAL_RCMD:return 1;case o[e].MANUAL_FLEX_RCMD:return 2;case o[e].MANUAL_MOVE_FLEX:return 3;case o[e].ONLY_RCMD:return 4;case o[e].TOP_FIX_MOVE_FLEX:return 5;case o[e].TOP_FIX_ONLY_RCMD:return 6;default:return 1}},p=function(){var t=d(),e=t.ENV;return t.isEnvSupported?(0,r.getVariateConfig)(i.CAT_RCMD[e])===s[e].OLD_MANUAL?0:(0,r.getVariateConfig)(i.CAT_RCMD[e])===s[e].MANUAL_RCMD?1:0:0}},3489:function(t,e,n){"use strict";n.d(e,{Z:function(){return at}});var r=n(3804),i=n.n(r),a=n(6704),o=n(1709),s=n(5325),u=n(21),c=n(1470),_=n(8210),f=n(7762),d=n(7365),E=n(8827),l=n(4857),S=n(5552),m=n(8244),A=n(4219),p=n(1437),I=n(4174);function L(){return L=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},L.apply(this,arguments)}n(3342),n(2493);var T=function(t,e){var n=t.find((function(t){return t===e}));return e&&n&&(t=t.filter((function(t){return t!==e}))).unshift(n),t};function h(){return h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},h.apply(this,arguments)}function O(){return O=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},O.apply(this,arguments)}function v(t,e){switch(e.type){case A.gm.REQUESTED:var n,r=e.categoryid,i=e.isInitialFetch;return O({},t,((n={})[r]=i?{items:[],normalisedItems:{},fetchedItemNumber:0,initialFetchStatus:m.a.REQ}:t[r],n));case A.gm.SUCCESS:var a,o=e.items,s=e.categoryid,u=e.isInitialFetch,c=t[s],_=c.items,f=c.fetchedItemNumber,d=c.initialFetchStatus,E=_.concat(o),l=o.reduce((function(t,e){return t[e.itemid]=e,t}),O({},t[s].normalisedItems));return O({},t,((a={})[s]={items:E,normalisedItems:l,fetchedItemNumber:f+o.length,initialFetchStatus:u?m.a.OK:d},a));case A.gm.FAILED:var S,p=e.categoryid,I=e.isInitialFetch;return O({},t,((S={})[p]=I?{items:[],normalisedItems:{},fetchedItemNumber:0,initialFetchStatus:m.a.ERR}:t[p],S))}}function g(){return g=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},g.apply(this,arguments)}function R(){return R=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},R.apply(this,arguments)}function C(){return C=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},C.apply(this,arguments)}function N(){return N=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},N.apply(this,arguments)}var F=n(6143);function y(){return y=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},y.apply(this,arguments)}function D(){return D=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},D.apply(this,arguments)}function M(){return M=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},M.apply(this,arguments)}function H(t){for(var e={0:{itemIdsToFetch:[],boundaries:"",isRequested:!1}},n=0;n<t.length;n+=A.LX){var r=n+A.LX<=t.length?n+A.LX:t.length,i=t.slice(n,r);e[Math.floor(n/A.LX)]={itemIdsToFetch:i,boundaries:i[0]+"-"+i[i.length-1],isRequested:!1}}return e}var b={flashSaleAllSessions:function(t,e){switch(void 0===t&&(t={promotionIds:[],sessions:{}}),e.type){case A.mL.REQUESTED:case A.mL.FAILED:return t;case A.mL.SUCCESS:var n=e.payload,r=n.sessions,i=n.recommendation_trace_id;return{promotionIds:r.map((function(t){return t.promotionid})),sessions:r.reduce((function(t,e){return t[e.promotionid]=L({},e,{recommendation_trace_id:i}),t}),{})};case A.Ft.SUCCESS:var a=(0,p.isFeatureEnabled)(I.kOz),o={catid:A.tl,catname:"",image:""},s=e.payload,u=s.promotionid,c=s.data.selling_out_item_brief_list;if(a&&c.length>4){var _=t.sessions[u].categories;t.sessions[u].categories=[_[0],o].concat(_.slice(1))}return L({},t);case A.gH:return{promotionIds:[],sessions:{}};default:return t}},fetchFlashSaleAllSessionsStatus:function(t,e){switch(void 0===t&&(t=m.a.INIT),e.type){case A.mL.REQUESTED:return m.a.REQ;case A.mL.SUCCESS:return m.a.OK;case A.mL.FAILED:return m.a.ERR;case A.gH:return m.a.INIT;default:return t}},flashSaleItemIds:function(t,e){switch(void 0===t&&(t={}),e.type){case A.Ft.REQUESTED:var n;return h({},t,((n={})[e.payload.promotionid]={fetchItemIdsStatus:m.a.REQ},n));case A.Ft.FAILED:var r;return h({},t,((r={})[e.payload.promotionid]={fetchItemIdsStatus:m.a.ERR},r));case A.Ft.SUCCESS:var i,a=e.payload,o=a.data,s=o.item_brief_list,u=o.selling_out_item_brief_list,c=a.selectedItemId;return h({},t,((i={})[a.promotionid]=function(t){var e,n=t.item_brief_list,r=t.selectedItemId,i={itemids:t.selling_out_item_brief_list.map((function(t){return t.itemid}))},a=n.map((function(t){return t.itemid})),o={itemids:T(a,r)};return h({},n.reduce((function(t,e){var n=e.catid,r=e.itemid;return t[n]=t[n]||{itemids:[]},t[n].itemids.push(r),t}),{}),((e={})[A.g$]=o,e[A.tl]=i,e.fetchItemIdsStatus=m.a.OK,e))}({item_brief_list:s,selling_out_item_brief_list:u,selectedItemId:c}),i));case A.Ex:var _,f,d=e.payload,E=d.promotionid,l=d.itemId,S=t[E][A.g$].itemids,p=T(S,l);return h({},t,((f={})[E]=h({},t[E],((_={})[A.g$]=h({},t[E][A.g$],{itemids:p}),_)),f));case A.hh:var I,L,O=e.payload,v=O.boundariesOfItemIdsToFetch,g=O.fetchedItemIds,R=O.promotionid,C=O.categoryid,N=t[R][C].itemids,F=v.split("-").map((function(t){return parseInt(t,10)})),y=N.indexOf(F[0]),D=N.indexOf(F[1]),M=N.slice(0,y),H=N.slice(D+1),b=M.concat(g).concat(H);return h({},t,((L={})[R]=h({},t[R],((I={})[C]=h({},t[R][C],{itemids:b}),I)),L));case A.gH:return{};default:return t}},fetchFlashSaleItemIdsStatus:function(t,e){switch(void 0===t&&(t=m.a.INIT),e.type){case A.Ft.REQUESTED:return m.a.REQ;case A.Ft.SUCCESS:return m.a.OK;case A.Ft.FAILED:return m.a.ERR;case A.gH:return m.a.INIT;default:return t}},flashSaleItemsOnLanding:function(t,e){void 0===t&&(t={});var n=e.type;switch(n){case A.gm.REQUESTED:var r,i=e.payload,a=i.promotionid,o=i.categoryid,s=i.isInitialFetch;return O({},t,((r={})[a]=v(t[a],{type:n,categoryid:o,isInitialFetch:s}),r));case A.gm.SUCCESS:var u,c=e.payload,_=c.data.items,f=c.promotionid,d=c.categoryid,E=c.isInitialFetch;return O({},t,((u={})[f]=v(t[f],{type:n,categoryid:d,isInitialFetch:E,items:_}),u));case A.gm.FAILED:var l,S=e.payload,m=S.promotionid,p=S.categoryid,I=S.isInitialFetch;return O({},t,((l={})[m]=v(t[m],{type:n,categoryid:p,isInitialFetch:I}),l));case A.Ex:var L,T=e.payload,h=T.promotionid,g=T.itemId,R=t[h][A.g$].items;return O({},t,((L={})[h]=function(t,e){var n,r=function(t,e){var n=t.find((function(t){return t.itemid===e}));return e&&n&&(t=t.filter((function(t){return t.itemid!==e}))).unshift(n),t}(e.items,e.itemId);return O({},t,((n={})[A.g$]=O({},t[A.g$],{items:r}),n))}(t[h],{items:R,itemId:g}),L));case A.gH:return{};default:return t}},fetchFlashSaleItemsOnLandingStatus:function(t,e){switch(void 0===t&&(t=m.a.INIT),e.type){case A.gm.REQUESTED:return m.a.REQ;case A.gm.SUCCESS:return m.a.OK;case A.gm.FAILED:return m.a.ERR;case A.gH:return m.a.INIT;default:return t}},fetchFlashItemsOnEntranceStatus:function(t,e){switch(void 0===t&&(t=m.a.INIT),e.type){case A.Vs.REQUESTED:return m.a.REQ;case A.Vs.SUCCESS:return m.a.OK;case A.Vs.FAILED:return m.a.ERR;case A.gH:return m.a.INIT;default:return t}},flashSaleItemsOnEntrance:function(t,e){switch(void 0===t&&(t={items:[],session:{}}),e.type){case A.Vs.REQUESTED:return t;case A.Vs.SUCCESS:var n=e.payload,r=n.item_brief_list,i=n.items,a=n.session,o=n.recommendation_trace_id,s=n.mfs_tracker_info;return{items:i.map((function(t){return g({},t,r.find((function(e){return e.itemid===t.itemid})),{recommendation_trace_id:o,mfs_tracker_info:s})})),session:a};case A.Vs.FAILED:return t;case A.gH:return{items:[],session:{}};default:return t}},flashSaleAllItemsRecommendation:function(t,e){var n;switch(void 0===t&&(t={}),e.type){case A.Ft.REQUESTED:case A.Ft.FAILED:return t;case A.Ft.SUCCESS:var r=e.payload,i=r.data.item_brief_list,a=r.recommendation_trace_id;return R({},t,(n=a,i.reduce((function(t,e){var r=e.itemid,i=e.from,a=e.recommendation_info,o=e.is_flex_boosting,s="boolean"==typeof o?o:-1;return t[r]={from:i,recommendation_info:a,recommendation_trace_id:n,is_flex_boosting:s},t}),{})));case A.gH:return{};default:return t}},categoriesByPromotion:function(t,e){switch(void 0===t&&(t={}),e.type){case A.mL.REQUESTED:case A.mL.FAILED:return t;case A.mL.SUCCESS:var n=e.payload.sessions.reduce((function(t,e){var n=e.promotionid,r=e.categories,i=r.reduce((function(t,e){return t[e.catid]=e,t}),{}),a=r.map((function(t){return t.catid}));return t[n]={categoryIds:a,categories:i},t}),{});return n;case A.Ft.SUCCESS:var r,i,a=(0,p.isFeatureEnabled)(I.kOz),o={catid:A.tl,catname:"",image:""},s=e.payload,u=s.promotionid,c=s.data.selling_out_item_brief_list,_=t[u],f=_.categoryIds,d=_.categories;return a&&c.length>4&&(f=[f[0],A.tl].concat(f.slice(1)),d=C({},d,((i={})[A.tl]=o,i))),C({},t,((r={})[u]={categoryIds:f,categories:d},r));case A.gH:return{};default:return t}},selectedPromotionId:function(t,e){void 0===t&&(t=null);var n=e.type,r=(e.payload||{}).selectedPromotionId;switch(n){case A.gM:case A.u:return r;case A.gH:return null;default:return t}},selectedCategoryId:function(t,e){void 0===t&&(t=null);var n=e.type,r=(e.payload||{}).selectedCategoryId;switch(n){case A.H6:case A.u:return r;case A.gH:return null;default:return t}},shouldMoveBarsUp:function(t,e){return void 0===t&&(t=!1),e.type===A.Oy?e.payload.shouldMoveBarsUp:t},queryObjects:function(t,e){switch(void 0===t&&(t={}),e.type){case A.u:var n,r=e.payload,i=r.selectedPromotionId,a=r.selectedCategoryId,o=r.selectedItemId;return N({},t,((n={})[i+"-"+a]=o?{fromItem:o,promotionId:i,categoryId:a}:{promotionId:i,categoryId:a},n));case A.gH:return{};default:return t}},timeSlotToIdMap:function(t,e){switch(void 0===t&&(t={}),e.type){case A.mL.SUCCESS:return e.payload.sessions.reduce((function(t,e){var n=e.promotionid,r=e.start_time+"-"+e.end_time;return r in t?t[r].flashSaleId=n:t[r]={flashSaleId:n},t}),y({},t));case F.IJ.SUCCESS:return e.payload.sessions.filter((function(t){return t.brands.length>0})).reduce((function(t,e){var n=e.promotionid,r=e.start_time+"-"+e.end_time;return r in t?t[r].brandSaleId=n:t[r]={brandSaleId:n},t}),y({},t));case A.gH:return{};default:return t}},soldOutItem:function(t,e){switch(void 0===t&&(t={item:{},fetchStatus:m.a.INIT}),e.type){case A.c5.REQUESTED:return D({},t,{fetchStatus:m.a.REQ});case A.c5.FAILED:return D({},t,{fetchStatus:m.a.ERR});case A.c5.SUCCESS:var n,r=e.payload.data.items;return D({},t,{item:(n={},n[r[0].itemid]=r[0],n),fetchStatus:m.a.OK});default:return t}},itemIdsByBatch:function(t,e){switch(void 0===t&&(t={}),e.type){case A.Ft.SUCCESS:var n=e.payload,r=n.data,i=r.item_brief_list,a=r.selling_out_item_brief_list,o=n.selectedItemId;return M({},t,function(t){var e,n=t.promotionid,r=t.item_brief_list,i=t.selectedItemId,a=H(t.selling_out_item_brief_list.map((function(t){return t.itemid}))),o=r.map((function(t){return t.itemid})),s=H(T(o,i)),u=r.reduce((function(t,e){var n=e.catid,r=e.itemid;return t[n]=t[n]||[],t[n].push(r),t}),{}),c={};for(var _ in u)c[n+"-"+_]=H(u[_]);return M({},c,((e={})[n+"-"+A.tl]=a,e[n+"-"+A.g$]=s,e))}({promotionid:n.promotionid,item_brief_list:i,selling_out_item_brief_list:a,selectedItemId:o}));case A.gm.REQUESTED:var s,u,c=e.payload,_=c.batchIndex,f=c.promotionid+"-"+c.categoryid;return M({},t,((u={})[f]=M({},t[f],((s={})[_]=M({},t[f][_],{isRequested:!0}),s)),u));case A.gH:return{};default:return t}}},U=(0,l.combineReducers)(b),P=n(6944),w=n(7752);function j(t){return t?t.path+"-"+t.cid+"-"+t.id:null}var G,V=n(4176);function B(){return B=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},B.apply(this,arguments)}var Q=Object.freeze({FLASH_SALE:0,BRAND_SALE:1,SHOP_FLASH_SALE:2}),X=((G={})[P.Ug]=function(t,e){var n,r=j(e.payload.extraData);if(!r)return t;var i=t[r]||{};return B({},t,((n={})[r]=B({},i,{progress:m.a.REQ}),n))},G[P.tk]=function(t,e){var n,r,i=e.payload,a=i.extraData,o=i.data,s=i.timestamp,u=i.promotion_info,c=i.timeslot_info,_=j(a);if(!_||!a)return t;var f,d,E=t[_]||{},l=o.sessions||E.sessions||[];if(0===l.length)return B({},t,((d={pathname:a.path,currentPromotionId:B({},t.currentPromotionId,(f={},f[_]=void 0,f))})[_]=B({},E,{sessions:l,progress:m.a.OK}),d));var S=a.soldout_setting;if(a.flash_sale_type===Q.SHOP_FLASH_SALE&&l.forEach((function(t){if(1===S){if(t.is_ongoing&&t.items){var e=t.items.filter((function(t){return 0===t.stock})),n=t.items.filter((function(t){return t.stock>0}));t.items=n.concat(e)}}else 2===S&&t.is_ongoing&&t.items&&(t.items=t.items.filter((function(t){return t.stock>0})))})),a.flash_sale_type===w.IG.FLASH_SALE_CATEGORY)if(2===S){if(l[0].is_ongoing){var A=l[0].items.filter((function(t){return t.stock>0}));A.length>=4&&(l[0].items=A)}}else{var p,I;if(l[0].is_ongoing&&0===l[0].items.filter((function(t){return t.stock>0})).length&&l.shift(),0===l.length)return B({},t,((I={pathname:a.path,currentPromotionId:B({},t.currentPromotionId,(p={},p[_]=void 0,p))})[_]=B({},E,{sessions:l,progress:m.a.OK}),I))}a.flash_sale_type===Q.SHOP_FLASH_SALE&&l.forEach((function(t){if(t.is_ongoing&&t.items&&t.items.filter((function(t){return 0===t.stock})).length>0){var e=t.promotionid.split("-").map((function(t){return Number(t)}));c.forEach((function(n){var r=new Set(n.promotion_info);e.forEach((function(t){r.has(t)&&r.delete(t)})),0===r.size&&(t.timeslot_info=n)}))}})),l.map((function(t){return t.signature={},(a.flash_sale_type===Q.SHOP_FLASH_SALE?t.promotionid.split("-").map((function(t){return Number(t)})):[t.promotionid]).forEach((function(e){var n;t.signature[e]=null===(n=u.filter((function(t){return t.promotionid===e}))[0])||void 0===n?void 0:n.signature})),t}));var L=s||Date.now()/1e3;return l=(l=l.filter((function(t){return t.end_time>L})).filter((function(t){return Array.isArray(t.items)}))).filter((function(t){return!t.is_ongoing||t.items.length>0})),B({},t,((r={pathname:a.path,currentPromotionId:B({},t.currentPromotionId,(n={},n[_]=a.currentPromotionId?a.currentPromotionId:l[0].promotionid,n))})[_]=B({},E,{sessions:l.map((function(e,n){return t[_].sessions?e.promotionid===a.currentPromotionId?e:t[_].sessions[n]:e})),progress:m.a.OK}),r))},G[P.KE]=function(t,e){var n,r=j(e.payload.extraData);if(!r)return t;var i=t[r]||{};return B({},t,((n={})[r]=B({},i,{progress:m.a.ERR}),n))},G[P.vm]=function(t,e){var n,r=e.payload,i=r.promotionId,a=j(r.extraData);return a?B({},t,{currentPromotionId:B({},t.currentPromotionId,(n={},n[a]=i,n))}):t},G);(0,V.Z)(X,{});var Y=n(7936),x=n(4676);function K(){return K=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},K.apply(this,arguments)}function W(t,e){switch(e.type){case x.rW.REQUESTED:return{itemIds:[],fetchStatus:m.a.REQ};case x.rW.FAILED:return{itemIds:[],fetchStatus:m.a.ERR};case x.rW.SUCCESS:var n=e.payload,r=n.item_brief_list,i=n.from_item,a=r.map((function(t){return t.itemid}));return{itemIds:T(a,i),fetchStatus:m.a.OK};default:return t}}function k(){return k=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},k.apply(this,arguments)}function J(t,e){var n=e.type,r=e.payload||{},i=r.items,a=r.isInitialFetch;switch(n){case x.Js.REQUESTED:return a?{items:{},numberOfFetchedItems:0,initialFetchStatus:m.a.REQ,fetchStatus:m.a.REQ}:k({},t,{fetchStatus:m.a.REQ});case x.Js.FAILED:return k({},t,a?{initialFetchStatus:m.a.ERR}:{fetchStatus:m.a.ERR});case x.Js.SUCCESS:var o=t.items,s=t.numberOfFetchedItems,u=t.initialFetchStatus,c=i.reduce((function(t,e){return t[e.itemid]=e,t}),{});return{items:k({},o,c),numberOfFetchedItems:s+i.length,initialFetchStatus:a?m.a.OK:u,fetchStatus:m.a.OK}}}function q(){return q=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},q.apply(this,arguments)}function z(){return z=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},z.apply(this,arguments)}function Z(){return Z=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Z.apply(this,arguments)}var $=(0,l.combineReducers)({fetchAllSessionsStatus:function(t,e){switch(void 0===t&&(t=m.a.INIT),e.type){case x.N9.REQUESTED:return m.a.REQ;case x.N9.FAILED:return m.a.ERR;case x.N9.SUCCESS:return m.a.OK;case A.gH:return m.a.INIT;default:return t}},allSessions:function(t,e){void 0===t&&(t={promotionIds:[],sessions:{}});var n=e.type,r=(e.payload||{}).sessions;switch(n){case x.N9.REQUESTED:case x.N9.FAILED:return t;case x.N9.SUCCESS:return{promotionIds:r.map((function(t){return t.promotionid})),sessions:r.reduce((function(t,e){return t[e.promotionid]=e,t}),{})};case A.gH:return{promotionIds:[],sessions:{}};default:return t}},itemIds:function(t,e){var n,r,i;void 0===t&&(t={});var a=e.type,o=(e.payload||{}).promotionid;switch(a){case x.rW.REQUESTED:return K({},t,((n={})[o]=W(t[o],e),n));case x.rW.FAILED:return K({},t,((r={})[o]=W(t[o],e),r));case x.rW.SUCCESS:return K({},t,((i={})[o]=W(t[o],e),i));case x.jP:var s,u=e.payload,c=u.boundariesOfItemIdsToFetch,_=u.fetchedItemIds,f=u.promotionid,d=t[f].itemIds,E=c.split("-").map((function(t){return parseInt(t,10)})),l=d.indexOf(E[0]),S=d.indexOf(E[1]),m=d.slice(0,l),p=d.slice(S+1),I=m.concat(_).concat(p);return K({},t,((s={})[f]=K({},t[f],{itemIds:I}),s));case x.q2:var L,h=e.payload.selectedPromotionId;return K({},t,((L={})[h]=function(t,e){if(e.type===x.q2){if(!t)return t;var n=e.payload.selectedItemId;return K({},t,{itemIds:T(t.itemIds,n)})}return t}(t[h],e),L));case A.gH:return{};default:return t}},items:function(t,e){var n,r,i;void 0===t&&(t={});var a=e.type,o=(e.payload||{}).promotionid;switch(a){case x.Js.REQUESTED:return k({},t,((n={})[o]=J(t[o],e),n));case x.Js.FAILED:return k({},t,((r={})[o]=J(t[o],e),r));case x.Js.SUCCESS:return k({},t,((i={})[o]=J(t[o],e),i));case A.gH:return{};default:return t}},selectedPromotionId:function(t,e){switch(void 0===t&&(t=null),e.type){case x.S4:return e.payload.selectedPromotionId;case A.gH:return null;default:return t}},recommendationInfo:function(t,e){switch(void 0===t&&(t={}),e.type){case x.rW.REQUESTED:case x.rW.FAILED:return t;case x.rW.SUCCESS:return q({},t,e.payload.item_brief_list.reduce((function(t,e){var n=e.itemid,r=e.recommendation_info;return t[n]={recommendationInfo:r},t}),{}));case A.gH:return{};default:return t}},queryObjects:function(t,e){switch(void 0===t&&(t={}),e.type){case x.S4:var n,r=e.payload,i=r.selectedPromotionId,a=r.selectedItemId,o=r.isLandingPage;return i in t||!o?t:z({},t,((n={})[i]=a?{fromItem:a,promotionId:i}:{promotionId:i},n));case A.gH:return{};default:return t}},itemIdsByBatch:function(t,e){switch(void 0===t&&(t={}),e.type){case x.rW.SUCCESS:var n,r=e.payload,i=r.item_brief_list,a=r.from_item,o=r.promotionid,s=i.map((function(t){return t.itemid})),u=T(s,a);return Z({},t,((n={})[o]=function(t){for(var e={},n=0;n<t.length;n+=x.iO){var r=n+x.iO<=t.length?n+x.iO:t.length,i=t.slice(n,r);e[Math.floor(n/x.iO)]={itemIdsToFetch:i,boundaries:i[0]+"-"+i[i.length-1],isRequested:!1}}return e}(u),n));case x.Js.REQUESTED:var c,_,f=e.payload,d=f.batchIndex,E=f.promotionid;return Z({},t,((_={})[E]=Z({},t[E],((c={})[d]=Z({},t[E][d],{isRequested:!0}),c)),_));case A.gH:return{};default:return t}}}),tt=n(3679),et=n(5121),nt=(0,E.K)({reducers:{flashSale:U,sMartFlashSale:$,micrositeFlashSaleSoldOut:function(t,e){switch(void 0===t&&(t={item:{},fetchStatus:m.a.INIT}),e.type){case w.bG.REQUESTED:return B({},t,{fetchStatus:m.a.REQ});case w.bG.FAILED:return B({},t,{fetchStatus:m.a.ERR});case w.bG.SUCCESS:var n,r=e.payload.sessions[0].items[0];return{item:(n={},n[r.itemid]=r,n),fetchStatus:m.a.OK};default:return t}},fsSoldoutRcmd:Y.O,rcmdShop:tt.I6,sharedSearch:et.X},enhancer:d.Uo.apply(void 0,[(0,l.applyMiddleware)(S.Z)])});function rt(){return rt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rt.apply(this,arguments)}var it=a.I18n.withI18nCollections,at=function(t){var e=i().forwardRef((function(e,n){return i().createElement(s.Provider,{store:nt.store},i().createElement(f.InjectReducerContext.Provider,{value:{injectAsyncReducer:nt.injectReducer}},i().createElement(i().Suspense,{fallback:i().createElement("div",null,i().createElement(_.Z,{show:!0,hideOverlay:!0}))},i().createElement(c.SV,{errorComponent:function(){return i().createElement("div",null,"App failed")}},i().createElement(o.Z,{onTrack:a.Tracking.onTrack},i().createElement(t,rt({},e,{ref:n})))))))})),n=function(t){return t.displayName||t.name||"Component"}(e);return e.displayName="WithFlashSaleWrap("+n+")",it([u.x7,u.L].concat(u.mD),(function(){return i().createElement("div",null)}))(e)}},4365:function(t,e,n){"use strict";t.exports=n.microfeI(2)},843:function(t,e,n){"use strict";t.exports=n.microfeI(3)},7705:function(t,e,n){"use strict";t.exports=n.microfeI(1)},1180:function(t,e,n){"use strict";t.exports=n.microfeI(4)},7944:function(t,e,n){"use strict";t.exports=n.microfeI(0)}}]);
//# sourceMappingURL=https://sourcemap.webfe.shopee.io/pcmall-flashsale/_/731.3a8935f06a77dfe26e5f.legacy.js.map